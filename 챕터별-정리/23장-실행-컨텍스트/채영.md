# 23장 실행 컨텍스트

## 다시 읽으면서 헷갈렸던 개념
- 함수 호출 방식에 따른 this 바인딩

## 4가지 타입의 소스코드가 실행 컨텍스트를 생성
그럼 실행컨텍스트는 뭐지? 자바스크립트의 동작원리를 담고 있는 핵심 개념. 

### [면접 질문] 실행 컨텍스트란 무엇인가요?
- 실행 컨텍스트(Execution Context)는 자바스크립트 코드가 실행되는 환경과 그 실행에 필요한 정보를 담는 추상적인 개념입니다.
코드가 실행될 때 자바스크립트 엔진은 실행 컨텍스트를 만들어 변수, 함수 선언, 스코프 체인, this 값 등을 저장하고 관리합니다.
전역 코드가 실행되면 전역 실행 컨텍스트가 생성되고, 함수가 호출될 때마다 새로운 함수 실행 컨텍스트가 생성되어 콜 스택(Call Stack)에 쌓였다가 실행이 끝나면 제거됩니다.
따라서 실행 컨텍스트는 "자바스크립트 코드의 실행 순서와 스코프를 결정하는 핵심 메커니즘"이라고 할 수 있습니다.

### 코드가 실행될 때 일어나는 동작 원리를 실행컨텍스트라고 하나보다
- 모든 소스코드는 실행에 앞서 평가과정을 거침.
- 자바스크립트 엔진은 2개의 과정 소스코드 평가와 소스코드 실행 과정으로 나누어 처리함
- 실행컨텍스트는 생성단계에서 변수, 함수 선언, 스코프체인, this값 저장 등이 일어나서 실행단계에서 코드 실행이 일어남. 
- 실행된 실행 컨텍스트는 콜스택에 쌓이고 코드가 실행되고 나면 스택에서 제거됨.
- 이때 실행컨텍스트는 소스코드 타입에 따라 생성됨. 전역일 경우 전역 실행 컨텍스트, 함수일 경우 함수 실행 컨텍스트
- 실행 컨텍스트는 코드가 실행되는 순서를 관리하는 역할을 함
- 실행컨텍스트 스택의 최 상위에 존재하는 실행 컨텍스트는 언제나 현재 실행중인 코드의 실행 컨텍스트임 ( 실행 컨텍스트 스택의 최상위에 존재하는 실행 컨텍스트 = 실행 중인 실행 컨텍스트 running execution context)

## 렉시컬 환경
- 식별자와 식별자에 바인딩된 값, 그리고 상위스코프에 대한 참조를 기록하는 자료구조
- 렉시컬 환경은 키와 값을 갖는 객체 형태의 스코프를 생성하여 식별자를 키로 등록하고 식별자에 바인딩된 값을 관리

### 실행컨텍스트의 컴포넌트
- Lexical Environment 컴포넌트와 Variable Environment 컴포넌트로 구성됨

## 실행컨텍스트의 키워드
- 변수환경, 렉시컬 환경, this바인딩

### 스코프체인과 실행컨텍스트의 관계
- 실행 컨텍스트는 자신만의 렉시컬 환경을 갖고 있고 이 환경이 상위 스코프에 대한 참조를 포함함. 실행 컨텍스트가 중첩될 때 참조들이 연결되어 스코프 체인이 형성되고 → 자바스크립트 엔진은 변수를 찾을 때 현재 컨텍스트 → 상위 컨텍스트 순으로 탐색함

### this 바인딩은 실행 컨텍스트 생성 시 어떻게 결정되는지
- 전역 컨텍스트 - 브라우저 window, Node.js global, 모듈에서는 undefined
- 일반 함수 호출 - strict mode 에서 undefined, 아니면 전역 객체
- 매서드 호출 - 메서드를 호출한 객체가 this
- 생성자 함수 호출 (new) - 새로 생성된 인스턴스 객체가 this
- 화살표 함수 - 자신만의 this를 가지지않고 선언될 당시 상위 실행 컨텍스트의 this를 그대로 사용  ( 화살표 함수는 자신이 정의된 위치의 렉시컬 this 를 가짐 )

### 렉시컬 스코프와 this바인딩의 차이
 - **렉시컬 스코프**: 함수가 **선언된 위치**에 따라 상위 스코프가 결정됨 (고정)
- **this 바인딩**: 함수가 **호출된 방식**에 따라 달라짐 (동적)

## 함께 학습하면 좋은 자료
- https://bigfrontend.dev/quiz/this

### this 4가지

> this가 언제 바인딩되는지를 포인트로 두고 복습하기
> 
- 이벤트의  (e) ⇒ e.target이 this
- 화살표 함수는 선언한 곳의 바로 상위 object를 무시한다.
- 전역에서 실행하면 this = window
    - 자바스크립트는 기본적으로 window라는 객체로 감싸져있기 때문
- this는 가장 가까운 오브젝트를 가리킨다.

[https://yuddomack.tistory.com/entry/자바스크립트-this의-4가지-동작-방식](https://yuddomack.tistory.com/entry/%EC%9E%90%EB%B0%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-this%EC%9D%98-4%EA%B0%80%EC%A7%80-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D)

즉시실행함수 → 함수의 this는 전역객체를 가리킨다.